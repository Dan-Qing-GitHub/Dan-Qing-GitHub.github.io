<html>

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no" />
    <title>ArcGIS API for JavaScript Tutorials: Display a map</title>
    <link rel="stylesheet" href="https://js.arcgis.com/4.19/esri/themes/light/main.css">
    <script src="https://js.arcgis.com/4.19/"></script>
    <style>
        html,
        body {
            padding: 0;
            margin: 0;
            height: 100%;
        }

        #viewDiv01 {
            float: left;
            padding: 0;
            margin: 0;
            height: 100%;
            width: 100%;


        }



        #basemapSwich {
            top: 20px;
            right: 20px;
            position: absolute;
            z-index: 99;
            background-color: white;
            border-radius: 8px;
            padding: 10px;
            opacity: 0.75;
        }

        #LayerCollection {
            top: 120px;
            right: 20px;
            position: absolute;
            z-index: 99;
            background-color: rgb(255, 251, 251);
            border-radius: 8px;
            padding: 10px;
            opacity: 0.75;
        }

        #co {
            top: 220px;
            right: 20px;
            position: absolute;
            z-index: 99;
            background-color: rgb(255, 255, 255);
            border-radius: 8px;
            padding: 10px;
            opacity: 0.95;
        }
    </style>



    <script>
        var myBasemap = "osm-standard";
        require([
            "esri/config",
            "esri/Map",
            "esri/widgets/Legend",
            "esri/layers/GeoJSONLayer",
            "esri/views/MapView",
            "esri/layers/FeatureLayer",
            "esri/widgets/LayerList",
            "esri/layers/MapImageLayer",
            "esri/layers/TileLayer",
            "esri/core/watchUtils"
        ],
            function (
                esriConfig,
                Map,
                Legend,
                GeoJSONLayer,
                MapView,
                FLayer,
                LayerList,
                MapImageLayer,
                TileLayer,
                watchUtils,
            ) {

                esriConfig.apiKey = "AAPK56e3ac027f044c4089d8ceec232fc05dYaOuzVRzm8tMRqvzOvDvIEevbqJ85yppn9PacU6cy4duurJrVK9wo_8BcWO8i8bi";

                const map = new Map({
                    basemap: "streets-navigation-vector", // Basemap layer service
                });

                const view01 = new MapView({
                    map: map,
                    center: [29.93, 11.93], // Longitude, latitude
                    zoom: 2, // Zoom level
                    container: "viewDiv01" // Div element
                });
                // *****************难民主要来源国************************
                const defaultSym = {
                    type: "simple-fill", // autocasts as new SimpleFillSymbol()
                    outline: {
                        // autocasts as new SimpleLineSymbol()
                        color: [128, 128, 128, 0.2],
                        width: "0.5px"
                    }
                };
                const or_renderer = {
                    type: "simple", // autocasts as new SimpleRenderer()
                    symbol: defaultSym,
                    label: "U.S. County",
                    visualVariables: [
                        {
                            type: "color",
                            field: "Total_2020",
                            legendOptions: {
                                title: "% population in poverty by county"
                            },
                            stops: [
                                {
                                    value: 10,
                                    color: "#350242",
                                    label: "<10%"
                                },
                                {
                                    value: 40,
                                    color: "#FF0066",
                                    label: ">30%"
                                }
                            ]
                        }
                    ]
                };
                const layer_1 = new GeoJSONLayer({
                    url: "https://dan-qing-github.github.io/Data/origin.geojson",
                    renderer: or_renderer, //optional
                    popupTemplate: {
                        // autocasts as new PopupTemplate()
                        title: "{Name}",
                        content: [
                            {
                                type: "media", // MediaContentElement
                                mediaInfos: [{
                                    type: "line-chart",
                                    caption: "",
                                    value: {
                                        fields: ["Refu_2015","Refu_2016","Refu_2017","Refu_2018","Refu_2019"],
                                        normalizeField: null,
                                        tooltipField: "relationships/0/COMMON"
                                    }
                                }]
                            }
                        ]
                    }
                });
                // *****************难民收容国************************
                const layer_2 = new GeoJSONLayer({
                    url: "https://dan-qing-github.github.io/Data/host.geojson",
                    renderer: or_renderer, //optional
                });
                map.add(layer_1);
                map.add(layer_2);
                // map.add(layer_3);
                // map.add(layer_4);
                // map.add(layer_5);

                // *****************MissionThree************************

                // 显示地理坐标
                view01.on("pointer-move", function (event) {
                    // 获取屏幕坐标
                    // var info = "x: " + event.x.toFixed(2) + " y: " + event.y.toFixed(2);
                    // 屏幕坐标转换为地理坐标                    
                    var info = "x: " + view01.toMap(event).latitude.toFixed(2) + " y: " + view01.toMap(event).longitude.toFixed(2);
                    document.getElementById("zb").innerHTML = info;
                });

            });


    </script>

</head>

<body>
    <div id="viewDiv01" class="viewDivBase"></div>


    <span id="basemapSwich" class="esri-widget">
        <button class="esri-button style-button" id="basemap01">gray-vector</button>
        <button class="esri-button style-button" id="basemap02">hybrid</button>
    </span>
    <span id="LayerCollection" class="esri-widget">
        <span id="layer01" style="background-color: rgb(255, 196, 108);"><input type="checkbox" id="vis01" /><button
                id="del01"></button>Layer01<br></span>
        <span id="layer02" style="background-color: rgb(186, 255, 108);"><input type="checkbox" id="vis02" /><button
                id="del02"></button>Layer02<br></span>

        <span id="innerText">共有图层数</span>
    </span>
    <span id="co" class="esri-widget">
        <div id="demo1">
            <p><span id="zb"></span></p>
        </div>

    </span>

</body>

</html>